function [reject,p_adjust] = fun_Bonferroni_Holm(p_list,alpha)
% fun_Bonferroni_Holm corrects p values using Bonferroni Holm correction.
%
% USAGE: [reject,p_adjust] = fun_Bonferroni_Holm(p_list,alpha)
%
% INPUTS:   p_list - an array of p values
%           alpha - significance criterion, default is 0.05
%
% OUTPUTS:  reject - a boolean array, whether to reject the null hypotheses
%           p_adjust - an array of adjusted p vlaue after correction

if nargin < 2
    alpha = 0.05;
end
num_p = length(p_list);
[p_list_sort,ind] = sort(p_list); % sort from lowest p value to highest
alpha_adjust = alpha./(num_p+1-(1:num_p));
k = find(p_list_sort > alpha_adjust,1);
reject = ones(size(p_list));
if ~isempty(k)
    reject(ind(k:end)) = 0;
end

for i = 1:num_p
    p_adujst_sort(i) = max(min([p_list_sort(1:i).*(num_p-(1:i)+1);ones(1,i)],[],1));
    p_adjust(ind(i)) = p_adujst_sort(i);
end
end