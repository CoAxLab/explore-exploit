% FIG_optpolicy_colorplot plots the optimal policy (Fig 1b)

figh = 105*3;
figw = 100*3;
figure('position',[100 100 figw figh]); hold on;

deltaV = fun_deltaVmat();
prer = 1*(deltaV>0);
prer(deltaV==0) = 0.5;
prer = fliplr(prer); % flip to get a descending order of t_left

hue = prer/3+2/3;
saturation = 1;
value = 1;

for ind1 = 1:size(prer,1)
    for ind2 = 1:size(prer,2)
        if isnan(prer(ind1,ind2))
            C(ind1,ind2,:) = [1,1,1];
        else
            C(ind1,ind2,:) = hsv2rgb([hue(ind1,ind2),saturation,value]);
        end
    end
end

image(C);
set(gca,'xtick',1:9); set(gca,'ytick',1:5:41);
set(gca,'LineWidth',1);
set(gca,'TickDir','out');
box off;
hold on;
xlim([0.5,9.5]); ylim([0.5,41.5]);
x = xlim;
y = ylim;
line([x(1) x(2)],[y(1) y(1)],'color',get(gca,'xcolor'),'LineWidth',1)
line([x(2) x(2)],[y(1) y(2)],'color',get(gca,'ycolor'),'LineWidth',1)
line([x(1) x(2)],[y(2) y(2)],'color',get(gca,'xcolor'),'LineWidth',1)
line([x(1) x(1)],[y(1) y(2)],'color',get(gca,'ycolor'),'LineWidth',1)
set(gca,'yticklabel',{'1','','2','','3','','4','','5'}); set(gca,'xticklabel',{'9','','7','','5','','3','','1'});
xlabel('Number of days left'); ylabel('Highest reward so far');
set(gca,'fontsize',20);