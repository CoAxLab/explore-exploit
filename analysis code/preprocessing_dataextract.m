function preprocessing_dataextract(subnum)
% preprocessing_dataconvert pre-processes the raw data of a given
% participant and exactes the variables for later analyses.

script_loadsubdata;

i=1;
sizedata = size(data);
while i <= sizedata(1)
    if data(i,3) == 1
        data(i,7) = data(i,6);
        maxreward = data(i,6);
        for j = i:i+data(i,2)-1
            maxreward = max(maxreward,data(j,6));
            data(j,7) = maxreward;
        end
        i = j+1;
    end
end

mu_origin=[nan; data(1:end-1,7)];

ind = data(:,3)>1;
datause = data(ind,:);
actions = datause(:,5);
totaldays = datause(:,2);
daysleft = datause(:,2)-datause(:,3)+1;
muvalue = mu_origin(ind);
RT = datause(:,4);

save(['data_extracted/extracted_sub' num2str(subnum) '.mat'],'actions','muvalue','daysleft','totaldays','RT');

end