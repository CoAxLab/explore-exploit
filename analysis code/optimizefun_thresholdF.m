function minusllh = optimizefun_thresholdF(model,pars,actions,muvalue,daysleft,totaldays)
% optimizefun_thresholdF specifies the Num and Prop models used in
% model fitting (modelfitting_thresholdF.m)

[k,b,beta] = deal(pars(1),pars(2),exp(pars(3)));

switch model
    case 2 % threshold: linear on number of days left
        threshold = k*daysleft + b;
    case 3 % threshold: linear on proportion of days left
        threshold = k*daysleft./totaldays + b;
end
threshold(threshold>5) = 5;
threshold(threshold<1) = 1;

pexplore = 1./(1+exp(-beta*(threshold - muvalue)));
minusllh = - sum(log(pexplore.*(actions==1) + (1-pexplore).*(actions==0)));

end