function result = fun_generatemoreinfotask(data)
% fun_generatemoreinfotask calculates the highest reward so far and the
% average reward for each trial (after carrying out the action and getting
% rewarded), and adds them to the raw data matrix

% original data:
% 1 trial index, 2 total number of days, 3 day, 4 RT, 5 action, 6 reward
% more info:
% 7 highest reward so far
% 8 average reward so far

i = 1;
sizedata = size(data);
while i <= sizedata(1)
    if data(i,3)==1
        data(i,7) = data(i,6);
        data(i,8) = data(i,6);
        maxreward = data(i,6);
        for j = i+1 : i+data(i,2)-1
            maxreward = max(maxreward,data(j,6));
            data(j,7) = maxreward; % highest reward so far
            data(j,8) = (data(j-1,8)*(data(j,3)-1)+data(j,6))/data(j,3);  % average reward
        end
        i = j+1;
    end
end
result = data;
end